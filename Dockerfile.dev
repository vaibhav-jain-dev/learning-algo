# DSAlgo Learn Platform - Development Dockerfile
# Optimized for hot-reload development with minimal footprint

FROM golang:1.21-alpine

# Install minimal dependencies
RUN apk add --no-cache \
    python3 \
    py3-pip \
    git \
    && rm -rf /var/cache/apk/*

# Install air for Go hot reload
RUN go install github.com/air-verse/air@latest

WORKDIR /app

# Copy go mod files and download deps
COPY backend/go.mod backend/go.sum* ./backend/
RUN cd backend && go mod download 2>/dev/null || true

# Copy source (will be overridden by volume mount)
COPY backend/ ./backend/
COPY frontend/ ./frontend/
COPY problems/ ./problems/
COPY topics/ ./topics/

EXPOSE 8080

# Run with air for hot reload
CMD ["air", "-c", ".air.toml"]
