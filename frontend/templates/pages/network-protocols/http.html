<style>
    .protocol-section { background: var(--bg-secondary, #f8fafc); padding: 24px; border-radius: 12px; margin-bottom: 24px; border: 1px solid var(--border-color, #e2e8f0); }
    .protocol-section h2 { font-size: 1.5rem; margin-bottom: 12px; color: var(--accent-primary, #3b82f6); }
    .protocol-section h3 { font-size: 1.2rem; margin-top: 20px; margin-bottom: 12px; color: var(--accent-secondary, #8b5cf6); }
    .diagram-container { background: var(--bg-tertiary, #f1f5f9); padding: 20px; border-radius: 10px; margin: 20px 0; overflow-x: auto; }
    .version-card { background: var(--bg-tertiary); padding: 20px; border-radius: 10px; margin-bottom: 16px; border-left: 4px solid var(--accent-primary); }
    .version-card h4 { color: var(--accent-primary); margin-bottom: 12px; font-size: 1.2rem; }
    .comparison-table { width: 100%; border-collapse: collapse; margin: 16px 0; font-size: 0.9rem; }
    .comparison-table th, .comparison-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border-color); }
    .comparison-table th { background: var(--bg-tertiary); }
    .feature-yes { color: #10b981; font-weight: 600; }
    .feature-no { color: #ef4444; }
    .feature-partial { color: #f59e0b; }
    .highlight-box { background: rgba(59, 130, 246, 0.08); padding: 16px; border-radius: 8px; border-left: 4px solid var(--accent-primary); margin: 16px 0; }
    .timeline { position: relative; padding-left: 30px; }
    .timeline::before { content: ''; position: absolute; left: 10px; top: 0; bottom: 0; width: 2px; background: var(--accent-primary); }
    .timeline-item { position: relative; margin-bottom: 24px; }
    .timeline-item::before { content: ''; position: absolute; left: -25px; top: 5px; width: 12px; height: 12px; border-radius: 50%; background: var(--accent-primary); }
    .timeline-year { font-weight: 700; color: var(--accent-primary); }

    /* Flow Diagram Styles */
    .flow-diagram { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); border-radius: 12px; padding: 24px; margin: 20px 0; }
    .flow-vertical { display: flex; flex-direction: column; align-items: center; gap: 8px; }
    .flow-step { display: flex; align-items: center; gap: 12px; width: 100%; max-width: 600px; }
    .flow-num { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; flex-shrink: 0; }
    .flow-content { background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 10px 14px; flex: 1; }
    .flow-content.blue { border-color: rgba(59, 130, 246, 0.4); background: rgba(59, 130, 246, 0.15); }
    .flow-content.green { border-color: rgba(16, 185, 129, 0.4); background: rgba(16, 185, 129, 0.15); }
    .flow-content.purple { border-color: rgba(139, 92, 246, 0.4); background: rgba(139, 92, 246, 0.15); }
    .flow-content.orange { border-color: rgba(245, 158, 11, 0.4); background: rgba(245, 158, 11, 0.15); }
    .flow-content.cyan { border-color: rgba(6, 182, 212, 0.4); background: rgba(6, 182, 212, 0.15); }
    .flow-title { color: #f1f5f9; font-weight: 600; font-size: 0.85rem; margin-bottom: 4px; }
    .flow-desc { color: #94a3b8; font-size: 0.75rem; }
    .flow-arrow-down { text-align: center; color: #64748b; font-size: 1.2rem; margin: 4px 0; }
    .flow-note { background: rgba(245, 158, 11, 0.1); border: 1px dashed rgba(245, 158, 11, 0.4); border-radius: 6px; padding: 8px 12px; margin: 8px 0; color: #fbbf24; font-size: 0.75rem; text-align: center; }
    .flow-row { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; justify-content: center; margin: 8px 0; }
    .flow-box { background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.4); color: #93c5fd; padding: 8px 14px; border-radius: 6px; font-size: 0.8rem; font-weight: 500; }
    .flow-box.active { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border-color: #3b82f6; }
    .flow-box.success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-color: #10b981; }
    .flow-box.purple { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; border-color: #8b5cf6; }
    .flow-box.orange { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border-color: #f59e0b; }
    .flow-box.cyan { background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white; border-color: #06b6d4; }
    .flow-arrow { color: #475569; font-size: 1rem; }
    .flow-label { color: #64748b; font-size: 0.7rem; margin-top: 4px; }

    /* Stack Comparison */
    .stack-comparison { display: flex; gap: 40px; justify-content: center; flex-wrap: wrap; }
    .stack-column { display: flex; flex-direction: column; align-items: center; gap: 4px; min-width: 140px; }
    .stack-header { color: #94a3b8; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
    .stack-box { width: 100%; padding: 10px 16px; border-radius: 6px; text-align: center; font-size: 0.8rem; font-weight: 500; }
    .stack-box.http2 { background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.4); color: #93c5fd; }
    .stack-box.http3 { background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.4); color: #6ee7b7; }
    .stack-box.highlight { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; }
    .stack-box.highlight-blue { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none; }
    .stack-note { margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px; font-size: 0.7rem; color: #94a3b8; text-align: left; max-width: 160px; }

    /* Sequence Diagram */
    .seq-diagram { display: flex; flex-direction: column; gap: 12px; }
    .seq-row { display: flex; align-items: center; gap: 12px; padding: 8px 0; }
    .seq-actor { min-width: 80px; text-align: center; }
    .seq-actor-label { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 600; }
    .seq-actor-label.server { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); }
    .seq-message { flex: 1; display: flex; align-items: center; gap: 8px; }
    .seq-arrow-right { flex: 1; height: 2px; background: #10b981; position: relative; }
    .seq-arrow-right::after { content: ''; position: absolute; right: 0; top: -4px; border: 5px solid transparent; border-left-color: #10b981; }
    .seq-arrow-left { flex: 1; height: 2px; background: #06b6d4; position: relative; }
    .seq-arrow-left::before { content: ''; position: absolute; left: 0; top: -4px; border: 5px solid transparent; border-right-color: #06b6d4; }
    .seq-label { background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 4px; font-size: 0.7rem; color: #e2e8f0; white-space: pre-wrap; word-wrap: break-word; }

    /* Mobile code compatibility */
    code { white-space: pre-wrap; word-wrap: break-word; }
</style>

<div class="page-layout">
    <div class="page-main">
        <nav style="margin-bottom: 16px;"><a href="/network-protocols" style="color: var(--accent-primary);">&larr; Back to Network Protocols</a></nav>

        <h1>HTTP Protocol Versions & HTTPS</h1>
        <p class="text-muted mb-4">Evolution of HTTP from 1.0 to HTTP/3 - understanding the improvements and when to use each</p>

        <!-- Timeline -->
        <div class="protocol-section">
            <h2>HTTP Evolution Timeline</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <span class="timeline-year">1996 - HTTP/1.0</span>
                    <p>One request per TCP connection. Connection closed after each response.</p>
                </div>
                <div class="timeline-item">
                    <span class="timeline-year">1997 - HTTP/1.1</span>
                    <p>Keep-alive connections, chunked transfer, host header. Still dominant today.</p>
                </div>
                <div class="timeline-item">
                    <span class="timeline-year">2015 - HTTP/2</span>
                    <p>Multiplexing, header compression, server push. Major performance upgrade.</p>
                </div>
                <div class="timeline-item">
                    <span class="timeline-year">2022 - HTTP/3</span>
                    <p>QUIC protocol (UDP-based), eliminates head-of-line blocking. The future.</p>
                </div>
            </div>
        </div>

        <!-- HTTP/1.1 -->
        <div class="protocol-section">
            <h2>HTTP/1.1 - The Workhorse</h2>

            <div class="flow-diagram">
                <div style="color: #94a3b8; font-size: 0.75rem; text-align: center; margin-bottom: 16px;">HTTP/1.1 with Keep-Alive</div>
                <div class="flow-vertical">
                    <div class="flow-step">
                        <div class="flow-num">1</div>
                        <div class="flow-content blue">
                            <div class="flow-title">TCP Handshake</div>
                            <div class="flow-desc">Client &rarr; SYN &rarr; Server &rarr; SYN-ACK &rarr; Client &rarr; ACK</div>
                        </div>
                    </div>
                    <div class="flow-arrow-down">&darr;</div>
                    <div class="flow-step">
                        <div class="flow-num">2</div>
                        <div class="flow-content green">
                            <div class="flow-title">GET /index.html</div>
                            <div class="flow-desc">Client sends request &rarr; Server responds with 200 OK (HTML)</div>
                        </div>
                    </div>
                    <div class="flow-arrow-down">&darr;</div>
                    <div class="flow-step">
                        <div class="flow-num">3</div>
                        <div class="flow-content green">
                            <div class="flow-title">GET /style.css</div>
                            <div class="flow-desc">Client sends request &rarr; Server responds with 200 OK (CSS)</div>
                        </div>
                    </div>
                    <div class="flow-arrow-down">&darr;</div>
                    <div class="flow-step">
                        <div class="flow-num">4</div>
                        <div class="flow-content green">
                            <div class="flow-title">GET /app.js</div>
                            <div class="flow-desc">Client sends request &rarr; Server responds with 200 OK (JS)</div>
                        </div>
                    </div>
                    <div class="flow-note">Requests are SEQUENTIAL - One request waits for previous response</div>
                </div>
            </div>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Keep-Alive:</strong> Reuse TCP connection for multiple requests</li>
                <li><strong>Chunked Transfer:</strong> Stream response before knowing total size</li>
                <li><strong>Host Header:</strong> Multiple domains on same IP (virtual hosting)</li>
                <li><strong>Pipelining:</strong> Send multiple requests without waiting (rarely used)</li>
            </ul>

            <h3>Problems</h3>
            <ul>
                <li><strong>Head-of-Line Blocking:</strong> One slow request blocks all following requests</li>
                <li><strong>Redundant Headers:</strong> Same headers sent with every request (cookies, user-agent)</li>
                <li><strong>No Prioritization:</strong> Can't prioritize CSS over images</li>
            </ul>
        </div>

        <!-- HTTP/2 -->
        <div class="protocol-section">
            <h2>HTTP/2 - Multiplexing Revolution</h2>

            <div class="flow-diagram">
                <div style="color: #94a3b8; font-size: 0.75rem; text-align: center; margin-bottom: 16px;">HTTP/2 Multiplexing</div>
                <div class="flow-vertical">
                    <div class="flow-step">
                        <div class="flow-num">1</div>
                        <div class="flow-content blue">
                            <div class="flow-title">TCP + TLS Handshake</div>
                            <div class="flow-desc">Single connection established with encryption</div>
                        </div>
                    </div>
                    <div class="flow-arrow-down">&darr;</div>
                    <div style="width: 100%; max-width: 600px;">
                        <div style="color: #10b981; font-size: 0.7rem; margin-bottom: 8px; text-align: center;">PARALLEL STREAMS (All at once!)</div>
                        <div class="flow-row" style="justify-content: space-between;">
                            <div class="flow-content purple" style="flex: 1; margin: 4px;">
                                <div class="flow-title">Stream 1</div>
                                <div class="flow-desc">GET /index.html<br>Priority: HIGH</div>
                            </div>
                            <div class="flow-content purple" style="flex: 1; margin: 4px;">
                                <div class="flow-title">Stream 3</div>
                                <div class="flow-desc">GET /style.css<br>Priority: MED</div>
                            </div>
                            <div class="flow-content purple" style="flex: 1; margin: 4px;">
                                <div class="flow-title">Stream 5</div>
                                <div class="flow-desc">GET /app.js<br>Priority: LOW</div>
                            </div>
                        </div>
                    </div>
                    <div class="flow-arrow-down">&darr;</div>
                    <div style="width: 100%; max-width: 600px;">
                        <div style="color: #06b6d4; font-size: 0.7rem; margin-bottom: 8px; text-align: center;">PARALLEL RESPONSES</div>
                        <div class="flow-row" style="justify-content: space-between;">
                            <div class="flow-content cyan" style="flex: 1; margin: 4px;">
                                <div class="flow-title">HTML Response</div>
                                <div class="flow-desc">Delivered first</div>
                            </div>
                            <div class="flow-content cyan" style="flex: 1; margin: 4px;">
                                <div class="flow-title">CSS Response</div>
                                <div class="flow-desc">Interleaved</div>
                            </div>
                            <div class="flow-content cyan" style="flex: 1; margin: 4px;">
                                <div class="flow-title">JS Response</div>
                                <div class="flow-desc">Interleaved</div>
                            </div>
                        </div>
                    </div>
                    <div class="flow-note">ALL requests/responses PARALLEL - No head-of-line blocking at HTTP layer</div>
                </div>
            </div>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Multiplexing:</strong> Multiple requests/responses over single connection simultaneously</li>
                <li><strong>Header Compression (HPACK):</strong> Reduce header size by 85-90%</li>
                <li><strong>Server Push:</strong> Server can send resources before client requests them</li>
                <li><strong>Stream Prioritization:</strong> Tell server which resources are more important</li>
                <li><strong>Binary Protocol:</strong> More efficient parsing than text-based HTTP/1.1</li>
            </ul>

            <h3>Limitations</h3>
            <ul>
                <li><strong>TCP Head-of-Line Blocking:</strong> Packet loss still blocks all streams</li>
                <li><strong>TLS Required:</strong> Browsers only support HTTP/2 over HTTPS</li>
                <li><strong>Server Push Complexity:</strong> Hard to know what to push, often disabled</li>
            </ul>
        </div>

        <!-- HTTP/3 -->
        <div class="protocol-section">
            <h2>HTTP/3 - The Future (QUIC)</h2>

            <div class="flow-diagram">
                <div style="color: #94a3b8; font-size: 0.75rem; text-align: center; margin-bottom: 16px;">Protocol Stack Comparison</div>
                <div class="stack-comparison">
                    <div class="stack-column">
                        <div class="stack-header">HTTP/2 Stack</div>
                        <div class="stack-box http2">HTTP/2</div>
                        <div class="stack-box http2">TLS 1.2/1.3</div>
                        <div class="stack-box http2">TCP</div>
                        <div class="stack-box http2">IP</div>
                        <div class="stack-note">
                            TCP Handshake: 1-2 RTT<br>
                            TLS Handshake: 1-2 RTT<br>
                            <strong>Total: 2-4 RTT</strong>
                        </div>
                    </div>
                    <div class="stack-column">
                        <div class="stack-header">HTTP/3 Stack</div>
                        <div class="stack-box highlight-blue">HTTP/3</div>
                        <div class="stack-box highlight">QUIC (includes TLS 1.3)</div>
                        <div class="stack-box http3">UDP</div>
                        <div class="stack-box http3">IP</div>
                        <div class="stack-note">
                            QUIC + TLS: 0-1 RTT<br>
                            Connection migration<br>
                            <strong>No HoL blocking!</strong>
                        </div>
                    </div>
                </div>
            </div>

            <h3>QUIC Protocol Advantages</h3>
            <ul>
                <li><strong>0-RTT Connection:</strong> Reconnect instantly (for returning visitors)</li>
                <li><strong>No TCP Head-of-Line Blocking:</strong> Each stream independent at transport layer</li>
                <li><strong>Connection Migration:</strong> Switch networks (WiFi to 4G) without reconnecting</li>
                <li><strong>Built-in Encryption:</strong> TLS 1.3 mandatory, always encrypted</li>
                <li><strong>Improved Loss Recovery:</strong> Better congestion control</li>
            </ul>

            <h3>Adoption Status (2024)</h3>
            <ul>
                <li><strong>Google:</strong> YouTube, Search - 100% HTTP/3</li>
                <li><strong>Cloudflare:</strong> Default for all customers</li>
                <li><strong>Facebook/Meta:</strong> All apps use HTTP/3</li>
                <li><strong>Browser Support:</strong> Chrome, Firefox, Safari, Edge all support</li>
            </ul>
        </div>

        <!-- HTTPS / TLS -->
        <div class="protocol-section">
            <h2>HTTPS & TLS</h2>

            <div class="flow-diagram">
                <div style="color: #94a3b8; font-size: 0.75rem; text-align: center; margin-bottom: 16px;">TLS 1.3 Handshake (1-RTT)</div>
                <div class="seq-diagram">
                    <div class="seq-row">
                        <div class="seq-actor"><div class="seq-actor-label">Client</div></div>
                        <div class="seq-message">
                            <div class="seq-arrow-right"></div>
                        </div>
                        <div class="seq-actor"><div class="seq-actor-label server">Server</div></div>
                    </div>
                    <div style="text-align: center; margin: -8px 0 8px 0;">
                        <span class="seq-label">ClientHello + KeyShare</span>
                    </div>
                    <div class="seq-row">
                        <div class="seq-actor"></div>
                        <div class="seq-message">
                            <div class="seq-arrow-left"></div>
                        </div>
                        <div class="seq-actor"></div>
                    </div>
                    <div style="text-align: center; margin: -8px 0 8px 0;">
                        <span class="seq-label">ServerHello + KeyShare + Certificate + Finished</span>
                    </div>
                    <div class="seq-row">
                        <div class="seq-actor"></div>
                        <div class="seq-message">
                            <div class="seq-arrow-right"></div>
                        </div>
                        <div class="seq-actor"></div>
                    </div>
                    <div style="text-align: center; margin: -8px 0 8px 0;">
                        <span class="seq-label">Finished + [Encrypted Data]</span>
                    </div>
                    <div class="flow-note" style="margin-top: 16px;">Connection now encrypted - All HTTP traffic protected</div>
                </div>
            </div>

            <h3>Why HTTPS Matters</h3>
            <ul>
                <li><strong>Encryption:</strong> Data can't be read by intermediaries</li>
                <li><strong>Authentication:</strong> Server proves its identity via certificate</li>
                <li><strong>Integrity:</strong> Data can't be modified in transit</li>
                <li><strong>SEO:</strong> Google ranks HTTPS sites higher</li>
                <li><strong>Modern Features:</strong> HTTP/2, Service Workers require HTTPS</li>
            </ul>

            <h3>TLS Versions</h3>
            <table class="comparison-table">
                <tr><th>Version</th><th>Status</th><th>Notes</th></tr>
                <tr><td>TLS 1.0/1.1</td><td class="feature-no">Deprecated</td><td>Security vulnerabilities</td></tr>
                <tr><td>TLS 1.2</td><td class="feature-partial">Supported</td><td>Still widely used</td></tr>
                <tr><td>TLS 1.3</td><td class="feature-yes">Recommended</td><td>Faster, more secure</td></tr>
            </table>
        </div>

        <!-- Comparison Table -->
        <div class="protocol-section">
            <h2>Version Comparison</h2>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>HTTP/1.1</th>
                        <th>HTTP/2</th>
                        <th>HTTP/3</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Year</td>
                        <td>1997</td>
                        <td>2015</td>
                        <td>2022</td>
                    </tr>
                    <tr>
                        <td>Transport</td>
                        <td>TCP</td>
                        <td>TCP</td>
                        <td>QUIC (UDP)</td>
                    </tr>
                    <tr>
                        <td>Multiplexing</td>
                        <td class="feature-no">No</td>
                        <td class="feature-yes">Yes</td>
                        <td class="feature-yes">Yes</td>
                    </tr>
                    <tr>
                        <td>Header Compression</td>
                        <td class="feature-no">No</td>
                        <td class="feature-yes">HPACK</td>
                        <td class="feature-yes">QPACK</td>
                    </tr>
                    <tr>
                        <td>Server Push</td>
                        <td class="feature-no">No</td>
                        <td class="feature-yes">Yes</td>
                        <td class="feature-yes">Yes</td>
                    </tr>
                    <tr>
                        <td>Connection Setup</td>
                        <td>2-4 RTT</td>
                        <td>2-3 RTT</td>
                        <td>0-1 RTT</td>
                    </tr>
                    <tr>
                        <td>HoL Blocking</td>
                        <td class="feature-no">HTTP + TCP</td>
                        <td class="feature-partial">TCP only</td>
                        <td class="feature-yes">None</td>
                    </tr>
                    <tr>
                        <td>TLS Required</td>
                        <td class="feature-no">Optional</td>
                        <td class="feature-partial">De facto</td>
                        <td class="feature-yes">Mandatory</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- When to Use -->
        <div class="protocol-section">
            <h2>Which Version to Use?</h2>

            <div class="highlight-box">
                <strong>2024 Recommendation:</strong>
                <ul style="margin-top: 8px;">
                    <li><strong>Default:</strong> HTTP/2 over TLS 1.3 - supported everywhere, significant improvements</li>
                    <li><strong>High-performance:</strong> HTTP/3 if your CDN/server supports it (Cloudflare, Google Cloud)</li>
                    <li><strong>Legacy:</strong> HTTP/1.1 only for old client compatibility or debugging</li>
                </ul>
            </div>

            <h3>Server Configuration</h3>
            <p>Most servers auto-negotiate the best protocol. Enable HTTP/2 and HTTP/3 in your server config:</p>
            <ul>
                <li><strong>Nginx:</strong> <code>listen 443 ssl http2;</code></li>
                <li><strong>Cloudflare:</strong> HTTP/3 enabled by default</li>
                <li><strong>AWS ALB:</strong> HTTP/2 supported, HTTP/3 via CloudFront</li>
            </ul>
        </div>
    </div>

    <aside class="page-sidebar">
        <div class="panel">
            <div class="panel-header">Quick Facts</div>
            <div class="quick-ref-item"><span class="quick-ref-key">HTTP/2</span><span class="quick-ref-value">97% browser support</span></div>
            <div class="quick-ref-item"><span class="quick-ref-key">HTTP/3</span><span class="quick-ref-value">75% browser support</span></div>
            <div class="quick-ref-item"><span class="quick-ref-key">TLS 1.3</span><span class="quick-ref-value">0.5 RTT faster</span></div>
        </div>
        <div class="panel mt-4">
            <div class="panel-header">Performance Gains</div>
            <div class="quick-ref-item"><span class="quick-ref-key">HTTP/2</span><span class="quick-ref-value">30-50% faster</span></div>
            <div class="quick-ref-item"><span class="quick-ref-key">HTTP/3</span><span class="quick-ref-value">10-15% vs HTTP/2</span></div>
        </div>
        <div class="panel mt-4">
            <div class="panel-header">Related</div>
            <a href="/network-protocols/rest" class="quick-ref-item" style="display:block;text-decoration:none;">REST API</a>
            <a href="/network-protocols/grpc" class="quick-ref-item" style="display:block;text-decoration:none;">gRPC</a>
        </div>
    </aside>
</div>
